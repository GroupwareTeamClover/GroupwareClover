<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="AdminMember">
	<select id="getAllData" resultType="java.util.HashMap">
		select employee.emp_seq, employee.emp_name, employee.emp_email, role.role_name, department.dept_name, worker_state.worker_state_name, employee_state.emp_state_name 
		from employee
        join department on employee.dept_code = department.dept_code
        join role on employee.role_code = role.role_code
        join worker_state on employee.worker_state_code = worker_state.worker_state_code
        join employee_state on employee.emp_state_code = employee_state.emp_state_code
        order by emp_seq desc
	</select>
	<select id="getCountMem" resultType="java.util.HashMap">
		select emp_state_code, count(*) from employee group by emp_state_code
	</select>
	<update id="updateMem" parameterType="map">
		update employee 
		set ${tbObject.stateCode} = (
		select ${tbObject.stateCode} 
		from ${tbObject.joinTable} 
		where ${tbObject.valueCol}= #{newValue}
		) 
		where emp_seq = #{empSeq}
	</update>
	
	<select id="getAllNew" resultType="com.clover.employee.dto.EmployeeDTO">
		select * from employee where emp_state_code = 0 or to_char(join_date, 'MM')=  to_char(sysdate,'MM')
	</select>
</mapper>