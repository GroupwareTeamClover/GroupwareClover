<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">
	<insert id="insertPost">
		insert into board values(board_sequence.nextval, #{boardlistSeq},
		#{boardTitle}, #{boardWriter}, #{boardContent}, sysdate, 0)
		<selectKey keyProperty="boardSeq" resultType="int"
			order="AFTER">
			SELECT board_sequence.CURRVAL FROM DUAL
		</selectKey>
	</insert>

	<select id="selectAllPost"
		resultType="com.clover.board.dto.BoardDTO">
		select * from board where boardlist_seq = #{boardlistSeq}
		order by board_seq desc
	</select>

	<select id="selectSearchedPost" parameterType="map"
		resultType="com.clover.board.dto.BoardDTO">
		SELECT *
		FROM board
		WHERE boardlist_seq = #{boardlistSeq}
		<if test="type != null and keyword != null">
			<choose>
				<when test="searchType == 'writer'">
					AND writer LIKE CONCAT('%', #{keyword}, '%')
				</when>
				<when test="searchType == 'title'">
					AND title LIKE CONCAT('%', #{keyword}, '%')
				</when>
			</choose>
		</if>
		order by board_seq desc
	</select>

</mapper>